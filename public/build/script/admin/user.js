let pValidator,pUserPinValidator;function userSubmit(e){e.preventDefault(),pValidator.validate()?(SnLoadingState(!0,"jsAction","userFormSubmit"),(e={}).password=document.getElementById("userPassword").value,e.passwordConfirm=document.getElementById("userPasswordConfirm").value,e.pinCode=document.getElementById("userPinCode").value,e.userId=document.getElementById("userId").value||0,RequestApi.fetch("/admin/appUser/updatePassword",{method:"POST",body:e}).then(e=>{e.success?(SnModal.close("userModalForm"),SnMessage.success({content:e.message}),maintenanceTable.getData()):dynamicResponseErrorModalMessage(e)}).finally(e=>{SnLoadingState(!1,"jsAction","userFormSubmit")})):dynamicFormSubmitInvalidMessage()}function userUpdatePassword(e,t,[s]){SnLoadingState(!0,"jsAction"),dynamicClearForm(pValidator,"userForm","userEmail"),RequestApi.fetch("/admin/appUser/id",{method:"POST",body:{id:s}}).then(e=>{e.success?(document.getElementById("userId").value=e.result.id,SnModal.open("userModalForm")):dynamicResponseErrorModalMessage(e)}).finally(e=>{SnLoadingState(!1,"jsAction")})}function userUserWareHouse(e,t,[s]){SnLoadingState(!0,"jsAction"),RequestApi.fetch("/admin/appUser/userWareHouse",{method:"POST",body:{id:s}}).then(e=>{e.success?(document.getElementById("userWareHouseUserId").value=s,document.getElementById("userWareHouseWrapper").innerHTML=e.view,SnModal.open("userWareHouseModalForm")):dynamicResponseErrorModalMessage(e)}).finally(e=>{SnLoadingState(!1,"jsAction")})}function userWareHouseSubmit(){SnLoadingState(!0,"jsAction","userWareHouseSubmit");let s=document.getElementById("userWareHouseUserId");var e=[...document.getElementById("userWareHouseCurrentTableBody").children].map((e,t)=>{e=e.dataset.warehouseid;return{wareHouseId:e,userWareHouseState:document.getElementById("userWareHouseState_"+e).checked,userId:s.value}});RequestApi.fetch("/admin/appUser/userWareHouseSave",{method:"POST",body:{userId:s.value||0,userWareHouse:e}}).then(e=>{e.success?(SnMessage.success({content:e.message}),SnModal.close("userWareHouseModalForm")):dynamicResponseErrorModalMessage(e)}).finally(e=>{SnLoadingState(!1,"jsAction","userWareHouseSubmit")})}function userUserCashBox(e,t,[s]){SnLoadingState(!0,"jsAction"),RequestApi.fetch("/admin/appUser/userCashBox",{method:"POST",body:{id:s}}).then(e=>{e.success?(document.getElementById("userCashBoxUserId").value=s,document.getElementById("userCashBoxWrapper").innerHTML=e.view,SnModal.open("userCashBoxModalForm")):dynamicResponseErrorModalMessage(e)}).finally(e=>{SnLoadingState(!1,"jsAction")})}function userCashBoxSubmit(){SnLoadingState(!0,"jsAction","userCashBoxSubmit");let s=document.getElementById("userCashBoxUserId");var e=[...document.getElementById("userCashBoxCurrentTableBody").children].map((e,t)=>{e=e.dataset.cashboxid;return{cashBoxId:e,userCashBoxState:document.getElementById("userCashBoxState_"+e).checked,userId:s.value}});RequestApi.fetch("/admin/appUser/userCashBoxSave",{method:"POST",body:{userId:s.value||0,userCashBox:e}}).then(e=>{e.success?(SnMessage.success({content:e.message}),SnModal.close("userCashBoxModalForm")):dynamicResponseErrorModalMessage(e)}).finally(e=>{SnLoadingState(!1,"jsAction","userCashBoxSubmit")})}function userUserDocument(e,t,[s]){SnLoadingState(!0,"jsAction"),RequestApi.fetch("/admin/appUser/userDocument",{method:"POST",body:{id:s}}).then(e=>{e.success?(document.getElementById("userDocumentUserId").value=s,document.getElementById("userDocumentWrapper").innerHTML=e.view,SnModal.open("userDocumentModalForm")):dynamicResponseErrorModalMessage(e)}).finally(e=>{SnLoadingState(!1,"jsAction")})}function userDocumentSubmit(){SnLoadingState(!0,"jsAction","userDocumentSubmit");let s=document.getElementById("userDocumentUserId");var e=[...document.getElementById("userDocumentCurrentTableBody").children].map((e,t)=>{e=e.dataset.documentid;return{documentTypeId:e,userDocumentState:document.getElementById("userDocumentState_"+e).checked,userId:s.value}});RequestApi.fetch("/admin/appUser/userDocumentSave",{method:"POST",body:{userId:s.value||0,documentTypes:e}}).then(e=>{e.success?(SnMessage.success({content:e.message}),SnModal.close("userDocumentModalForm")):dynamicResponseErrorModalMessage(e)}).finally(e=>{SnLoadingState(!1,"jsAction","userDocumentSubmit")})}function userLinkKey(e,t,[s]){SnLoadingState(!0,"jsAction"),dynamicClearForm(pUserPinValidator,"userPinForm","userPinCode"),RequestApi.fetch("/admin/appUser/getLinkKey",{method:"POST",body:{id:s}}).then(e=>{e.success?(document.getElementById("userPinId").value=s,document.getElementById("userPinCode").value=e.result.pin_code,document.getElementById("userPinUrl").innerHTML=e.view,SnModal.open("userPinModal")):dynamicResponseErrorModalMessage(e)}).finally(e=>{SnLoadingState(!1,"jsAction")})}function userPinSubmit(e){e.preventDefault(),pUserPinValidator.validate()?(SnLoadingState(!0,"jsAction","userPinFormSubmit"),(e={}).pinCode=document.getElementById("userPinCode").value,e.userId=document.getElementById("userPinId").value||0,RequestApi.fetch("/admin/appUser/updatePin",{method:"POST",body:e}).then(e=>{e.success?(SnModal.close("userModalForm"),SnMessage.success({content:e.message}),maintenanceTable.getData()):dynamicResponseErrorModalMessage(e)}).finally(e=>{SnLoadingState(!1,"jsAction","userPinFormSubmit")})):dynamicFormSubmitInvalidMessage()}document.addEventListener("DOMContentLoaded",()=>{pValidator=new Pristine(document.getElementById("userForm")),pUserPinValidator=new Pristine(document.getElementById("userPinForm")),maintenanceTable=new SnTable({elementId:"drawUserTable",entity:"user",data:e=>snTableFetchData("/admin/appUser/table",e),actions:appMenuActions,selectable:!1,columns:[{title:"Avatar",field:"avatar",customRender:e=>{var t=e.avatar.includes("http")?e.avatar:STORAGE_PUBLIC_URL+e.avatar;return`<div class="SnAvatar">
                    ${""!==e.avatar?`<img class="SnAvatar-img" src="${t}" alt="avatar">`:`<div class="SnAvatar-text">${e.user_name.substring(0,2)}</div>`}
                  </div>`}},{title:"Usuario",field:"user_name",filterable:!0,sortable:!0},{title:"Tipo documento",field:"identity_document_id_description",filterable:!0,sortable:!0},{title:"NÂ° de documento",field:"identity_document_number",filterable:!0,sortable:!0},{title:"Nombres",field:"full_name",filterable:!0,sortable:!0},{title:"Apellidos",field:"last_name",filterable:!0,sortable:!0},{title:"Email",field:"email",filterable:!0,sortable:!0},{title:"Rol",field:"user_role_id_description",filterable:!0,sortable:!0},...snTableAuditColumnRender()],filters:[...getUrlFilter()]})});