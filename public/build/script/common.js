const mimeTypesMap={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"Excel (xlsx)","application/vnd.ms-excel":"Excel (xls)","application/pdf":"PDF","application/msword":"Word (doc)","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"Word (docx)","image/jpeg":"Imagen JPEG","image/jpg":"Imagen JPG","image/png":"Imagen PNG","text/plain":"Texto plano","image/gif":"Imagen GIF"};function getFriendlyMimeTypes(e){return e.map(e=>mimeTypesMap[e]||e)}class RequestApi{static setHeaders(e){return e.body instanceof FormData?e.headers={Accept:"application/json",...e.headers}:(e.headers={Accept:"application/json","Content-Type":"application/json; charset=utf-8",...e.headers},e.body=JSON.stringify(e.body)),e}static fetch(e,t={}){NProgress.start();t=RequestApi.setHeaders(t);return fetch(URL_PATH+e,t).then(e=>e.json()).catch(e=>(SnMessage.danger({content:"ERROR FATAL JSON: "+e}),e)).finally(e=>{NProgress.done()})}static fetchOut(e,t={}){NProgress.start();t=RequestApi.setHeaders(t);return fetch(e,t).then(e=>e.json()).catch(e=>(SnMessage.danger({content:"ERROR FATAL JSON: "+e}),e)).finally(e=>{NProgress.done()})}static httpRequest(o,a={method:"GET"}){return new Promise((t,n)=>{NProgress.start();var e=new XMLHttpRequest;e.open(a.method,URL_PATH+o,!0),a.body instanceof FormData||(a.body=JSON.stringify(a.body)),e.upload.onprogress=function(e){e.lengthComputable&&"function"==typeof a.onProgress&&(e=e.loaded/e.total*100,a.onProgress(e))},e.onload=function(){if(NProgress.done(),200===this.status)try{var e=JSON.parse(this.responseText);t(e)}catch(e){t(this.responseText)}else n(this.statusText)},e.onerror=function(){NProgress.done(),n("Network error")},e.send(a.body)})}}const TableToExcel=(e,t="Sheet 1",n="report")=>{var o,e=new Blob([(t=>{var e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let e=0;e!=t.length;++e)n[e]=255&t.charCodeAt(e);return e})(atob((o={worksheet:t,table:e},t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table>{table}</table></body></html>'.replace(/{(\w+)}/g,function(e,t){return o[t]}),window.btoa(decodeURIComponent(encodeURIComponent(t))))))],{type:""}),t=document.createElement("a");t.download=n+".xls",t.href=URL.createObjectURL(e),t.click()};function numToWordCurrency(e){return numToWord(e)+` CON ${e.toString().split(".")[1]??"00"}/100`}function numToWord(e){var t=["","Un","Dos","Tres","Cuatro","Cinco","Seis","Siete","Ocho","Nueve","Diez","Once","Doce","Trece","Catorce","Quince","Dieciseis","Diecisite","Dieciocho","Diecinueve","Veinte","Veintiuno","Veintidós","Veintitrés","Veinticuatro","Veinticinco","Veintiseis","Veintisiete","Veintiocho","Veintinueve"],n=["","Diez","Veinte","Treinta","Cuarenta","Cincuenta","Sesenta","Setenta","Ochenta","Noventa","Cien"],e=parseInt(e);if(NaN==e)return"";var o=Math.trunc(e/1e6),a=Math.trunc(e/1e3%1e3),i=Math.trunc(e/100%10),r=Math.trunc(e/10%10),s=Math.trunc(e%10);let c="";if(1==o)return c="Un Millón"+(e%1e6!=0?" "+numToWord(e%1e6):"");if(2<=o&&o<=999)return c=numToWord(Math.trunc(e/1e6))+" Millones"+(e%1e6!=0?" "+numToWord(e%1e6):"");if(1==a)return c="Mil"+(e%1e3!=0?" "+numToWord(e%1e3):"");if(2<=a&&a<=999)return c=numToWord(Math.trunc(e/1e3))+" Mil"+(e%1e3!=0?" "+numToWord(e%1e3):"");if(100==e)return c=n[10];if(0==e)return c="Cero";if(0!=i&&(c=["","Ciento","Doscientos","Trescientos","Cuatrocientos","Quinientos","Seiscientos","Setecientos","Ochocientos","Novecientos"][i]),0!=r){if(1==r||2==r)return 0!=i&&(c+=" "),c+=t[e%100];0!=i&&(c+=" "),c+=n[r]}return 0!=s&&(0!=r?c+=" y ":0!=i&&(c+=" "),c+=t[s]),c}function SnLoadingState(e,t,n=null){t=document.querySelectorAll("."+t),n=document.getElementById(n);e?(n&&(n.setAttribute("disabled","disabled"),n.classList.add("loading")),t&&t.forEach(e=>{e.setAttribute("disabled","disabled")})):(n&&(n.removeAttribute("disabled"),n.classList.remove("loading")),t&&t.forEach(e=>{e.removeAttribute("disabled")}))}const validateRUC=e=>{if(isNaN(e))return!1;if(!(1e10<=e&&e<11e9||15e9<=e&&e<18e9||2e10<=e&&e<21e9))return!1;let t,n=0;for(t=-(e%10<2);n<11;n++,e=e/10|0)t+=e%10*(n%7+(n/7|0)+1);return t%11==0};function validateFile(e,t,n){var o,a=getFriendlyMimeTypes(t);return t.includes(e.type)?(t=n/1024,!(n<(o=e.size/1024)&&(t=1024<o?`${(o/1024).toFixed(2)} MB (máximo permitido: ${t.toFixed(2)} MB)`:o.toFixed(2)+` KB (máximo permitido: ${n} KB)`,SnModal.danger({title:"Archivo demasiado grande",content:`El archivo que has seleccionado es demasiado grande. Tamaño: ${t}.`}),1))):(o=mimeTypesMap[e.type]||e.type,SnModal.danger({title:"Archivo no soportado",content:`Parece que has seleccionado un tipo de archivo que no podemos aceptar (${o}). Por favor, elige un archivo de tipo: ${a.join(", ")}.`}),!1)}function dynamicFormSubmitInvalidMessage(){SnModal.warning({title:"ALERTA USUARIO",content:"Verifica si los capos del formulario estén correctamente validados",okClassNames:"warning"})}function dynamicResponseErrorModalMessage(e){var t=e.errorType||"danger",n=e.errorType||"primary";"warning"===t&&(e.message=e.message.split("|").map(e=>`<div>${e}</div>`).join("")),SnModal.confirm({confirm:!1,title:e.title||"",content:e.message,type:t,okClassNames:n}),SnMessage.message(e.message,6e3,t,t)}function dynamicClearForm(e,t,n,o=""){t=document.getElementById(t),t&&t.reset(),t=document.getElementById(o);t&&(t.innerHTML=""),e.reset();const a=document.getElementById(n);a&&setTimeout(()=>{a.focus()},500)}function dynamicLoadFormValidate(e,t){return e&&e.destroy(),new Pristine(document.getElementById(t))}function dynamicTableToExcel(e,t){e=document.getElementById(e);e&&TableToExcel(e.outerHTML,"Hoja 1",t)}function dynamicTableToPdf(e,t="Document",n=!0){printJS({printable:e,type:"html",documentTitle:t,scanStyles:n,css:URL_PATH+"/build/css/print.css"})}function dynamicViewKeyboardListeners(screenName,menuData=[]){document.addEventListener("keydown",e=>{if(e.key){const eventKeyName=e.key.toUpperCase();menuData.forEach(item=>{if(("TOOLBAR"===item.position||"FOOTER"===item.position)&&0<item.keyboard_key.length){const keySplit=item.keyboard_key.toUpperCase().split("+"),eventFunctionName=(0<item.event_name_prefix.length?item.event_name_prefix:screenName)+item.event_name;if(1<keySplit.length){const preKey=keySplit[0],comKey=keySplit[1];(e.ctrlKey&&"CTRL"===preKey&&eventKeyName===comKey||e.altKey&&"ALT"===preKey&&eventKeyName===comKey)&&(e.preventDefault(),eval(""+eventFunctionName)(screenName,item.screen_id_controller))}else eventKeyName===item.keyboard_key.toUpperCase()&&!1===e.ctrlKey&&!1===e.altKey&&!1===e.shiftKey&&(e.preventDefault(),eval(""+eventFunctionName)(screenName,item.screen_id_controller))}})}})}function dynamicResponseSuccess(e,t,n,o){SnModal.confirm({type:"success",title:"OPERACIÓN EXITOSA",content:t,okText:e?"Refrescar":"Crear nuevo",okClassNames:"primary radio",cancelClassNames:"radio",cancelText:"Listar",onOk(e){"function"==typeof n&&n(e)},onCancel(e){"function"==typeof o&&o(e)}})}let SnLiveList=r=>{document.querySelectorAll(r.elem).forEach(n=>{let o=document.createElement("ul");o.classList.add("SnLiveList");const a=(e,t)=>{r.onSelect(e,t),o.remove()},t=()=>{var e=n.parentNode;e.querySelector(".SnLiveList")||e.appendChild(o);{var t=n.getBoundingClientRect();o.style.top=t.height+"px",o.style.width=t.width+"px"}},i=e=>{0===n.value.length||0===e.length?o.remove():"object"==typeof e?(o.innerHTML="",e.forEach((t,e)=>{var n=document.createElement("li");n.setAttribute("data-type","data"),n.setAttribute("data-index",e),n.classList.add("SnLiveList-item"),n.innerHTML=t.text,o.appendChild(n),n.addEventListener("click",e=>{e.preventDefault(),a(e,t)})}),t()):"string"==typeof e&&(o.innerHTML=`<li data-type="alert" class="SnLiveList-item alert">${e}</li>`,t())};n.addEventListener("input",function(e){e.preventDefault(),r.data&&"function"==typeof r.data&&r.data(n.value,i)})})};function appLeftPanelClose(){var e=document.getElementById("drawTableInfo");e&&e.classList.remove("active")}function appLeftPanelToggle(){var e=document.getElementById("drawTableInfo");e&&e.classList.toggle("active")}function appLeftPanelGetContent(e,t){var n;0!==t.length&&((n={}).id=t[0],SnLoadingState(!0,"jsAction"),RequestApi.fetch("/admin/appSidebar/getByScreenName",{method:"POST",body:{screenName:e,dynamicWhere:n}}).then(e=>{if(e.success){const t=document.getElementById("drawTableInfoContent");t&&(t.innerHTML="",e.result.forEach(e=>{let n="";e.options.forEach(e=>{var t=0<e.url_ref.length?`<a href="${e.url_ref.replaceAll("{{URL_PATH}}",URL_PATH)}" target="${e.url_ref.replaceAll("{{URL_PATH}}",URL_PATH)}" rel="noopener noreferrer">${e.value}</a>`:e.value;n+=`<li style="display: flex; justify-content: space-between; align-items: center;"><span>${e.description}</span><span>${t}</span></li>`}),t.insertAdjacentHTML("beforeend",`<h3 class="LeftPanel-title">${e.title}</h3><ul class="SnList">${n}</ul>`)}))}else dynamicResponseErrorModalMessage(e)}).finally(e=>{SnLoadingState(!1,"jsAction")}))}function navigatorGoTo(e,t,n=""){var t=new URLSearchParams(t).toString(),o=document.createElement("a");o.setAttribute("href",URL_PATH+e+(0<t.length?"?"+t:"")),o.setAttribute("target",n),o.click()}const copyToClipboard=e=>navigator&&navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e):Promise.reject("The Clipboard API is not available."),dateDDMMMYYYToStdFormat=(e,t=0)=>{var n="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_");const o=e.split("-");e=o[0],n=n.findIndex(e=>e===o[1].toLowerCase())+1;return o[2]+`-${("00"+n).slice(-2)}-`+e};async function snTableFetchData(e,t){e=await RequestApi.fetch(e,{method:"POST",body:t});return e.success?e.result:(SnModal.confirm({confirm:!1,title:e.title,content:e.message,type:e.errorType}),[])}function snTableAuditColumnRender(){return[{title:"Crea úl. usuario",field:"created_user",filterable:!0,sortable:!0,visible:!1},{title:"Crea úl. fecha",field:"created_at",filterable:!0,sortable:!0,visible:!1},{title:"Modifica úl. usuario",field:"updated_user",filterable:!0,sortable:!0,visible:!1},{title:"Modifica úl. fecha",field:"updated_at",filterable:!0,sortable:!0,visible:!1}]}function formatNumber(e,t=2){return isNaN(e)?0:parseFloat(e).toLocaleString("es-US",{style:"decimal",minimumFractionDigits:t,maximumFractionDigits:t})}function fixedNumber(e,t=2){return isNaN(e)?0:parseFloat(parseFloat(e).toFixed(t))}